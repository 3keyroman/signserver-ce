<!doctype html>

<html lang="en">

    <head>

        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">

        <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1">

        <link rel="icon" href="_scroll_external/attachments/e415105eb31a/ssdocs">

        <!-- Primary Meta Tags -->
        <meta name="exp-export-timestamp" content="2024-10-09T09:36:42.283+0000">
        <meta name="exp-page-id" content="371000790">
        <meta name="exp-page-title" content="Client-Side Hashing">
        <meta name="exp-page-version" content="3">
        <meta name="exp-page-scroll-page-id" content="baa6df313e6bc568e38e81377896a7b8">
        <meta name="exp-page-created" content="2024-02-02T08:31:13.000+0000">
        <meta name="exp-page-last-modified" content="2024-09-25T07:32:02.543+0000">
        <meta name="exp-page-labels" content="review,signserveree">
        <meta name="exp-page-context-keys" content="">
        <meta name="exp-space-key" content="SSDOCS">
        <meta name="exp-space-title" content="SignServer Documentation">

        <!-- Additional Meta Tags -->
        <meta name="exp-document-id" content="371111034">
        <meta name="exp-document-title" content="SignServer Documentation">
        <meta name="exp-version-status" content="in-progress">
        <meta name="exp-version-id" content="8a3e757d15e64586aa644eaf0980f27a">
        <meta name="exp-version-name" content="Working version">
        <meta name="exp-version-description" content="">
        <meta name="exp-version-date" content="2024-02-17T13:18:25Z">
        <meta name="exp-variant-id" content="">
        <meta name="exp-variant-name" content="">
        <meta name="exp-variant-description" content="">
        <meta name="exp-language-code" content="">
        <meta name="exp-language-name" content="">

        <link rel="stylesheet" href="css/app.css">
        <link rel="stylesheet" href="css/image-dimensions.css">


            
            
<script src="js/search.js"></script>
            <script id="search-worker" type="javascript/worker">
    onmessage = function(event) {
        // dispatch events to handling functions
        var message = event.data;

        if ((message.type === 'setup') && message.baseUrl) {
            setup(message.baseUrl);
        }

        if (message.type === 'search-request') {
            search(message.query);
        }
    }

    var searchIndex;

    function setup(baseUrl) {
        importScripts(
            baseUrl + 'js/lunr.js',
            baseUrl + 'js/lunr-index.js',
            baseUrl + 'js/lunr-data.js'
        );
        try {
            // load lunr-extras if it exists, which contains language-specific files for languages other than english
            importScripts(baseUrl + 'js/lunr-extras.js');
        } catch (e) {}
        searchIndex = lunr.Index.load(lunrIndex);
    }

    function search(query) {
        var searchHits = searchIndex.search(query);
        var results = searchHits.map(function (result) {
            return lunrData.filter(function (d) {
                return d.id === result.ref;
            })[0]
        });
        postMessage({ type: 'search-results', results: results, query: query });
    }
</script>
        <title>Client-Side Hashing</title>

    <meta name="generator" content="Scroll HTML Exporter / K15t GmbH"></head>

    <body id="Client-SideHashing-top" data-pageid="371000790" data-confluence-editor-version="v1" data-confluence-deployment-type="CLOUD">

        <div class="exp-grid-container">

            <header class="exp-header"></header>

            <div class="exp-logo">
                <a href="SignServer_Documentation.html">
                    <span class="exp-logo-image" style="background-image: url(_scroll_external/attachments/e415105eb31a/ssdocs)" alt="SignServer Documentation" title="SignServer Documentation"></span>
                </a>
            </div>

            <div class="exp-document-title">
                <h1 class="exp-document-title-heading scroll-original-h2 scroll-custom-section-heading scroll-document-section-heading scroll-h1 scroll-relative-h1" data-scroll-heading-rank="1" data-scroll-original-heading-rank="2" data-scroll-relative-heading-rank="1" id="no-src_generated-id-0a7d702672a5dd74a608275028ab467aa463359076bed1324f686114bb98c771">
                    <a href="SignServer_Documentation.html">
                        SignServer Documentation
                    </a>
                </h1>
            </div>

<div class="exp-search-container">
    <input type="search" id="search-textbox" autocomplete="off" class="exp-search-input" style="margin-right: 0;">
    <div class="exp-search-input-icon">
        <svg data-exp-id="magnifier-icon" data-exp-component="icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewbox="0 0 20 20" fill="none" aria-hidden="true">
            <path d="M8.99452 14.5C10.5121 14.5 11.809 13.9669 12.8854 12.9007C13.9618 11.8345 14.5 10.5361 14.5 9.00548C14.5 7.48794 13.9631 6.19097 12.8893 5.11458C11.8155 4.03819 10.519 3.5 9 3.5C7.46786 3.5 6.16816 4.0369 5.1009 5.11071C4.03363 6.18453 3.5 7.48096 3.5 9C3.5 10.5321 4.0331 11.8318 5.09929 12.8991C6.1655 13.9664 7.46391 14.5 8.99452 14.5ZM9 16C8.02913 16 7.11974 15.816 6.27185 15.4479C5.42395 15.0799 4.68056 14.5799 4.04167 13.9479C3.40278 13.316 2.90278 12.576 2.54167 11.728C2.18056 10.88 2 9.97053 2 8.99956C2 8.04152 2.18403 7.13542 2.55208 6.28125C2.92014 5.42708 3.41864 4.68387 4.04758 4.0516C4.67653 3.41935 5.41569 2.91935 6.26508 2.5516C7.11449 2.18387 8.02548 2 8.99806 2C9.95769 2 10.8646 2.18403 11.7188 2.55208C12.5729 2.92014 13.316 3.42014 13.9479 4.05208C14.5799 4.68403 15.0799 5.42612 15.4479 6.27835C15.816 7.13058 16 8.0381 16 9.00094C16 9.83365 15.8615 10.6213 15.5846 11.3638C15.3078 12.1062 14.9254 12.7836 14.4375 13.3958L18 16.9583L16.9375 18L13.375 14.4583C12.7668 14.9459 12.0939 15.3247 11.3564 15.5948C10.6188 15.8649 9.83333 16 9 16Z" fill="currentColor" />
        </svg>
    </div>
    <div id="search-suggestion-container" class="exp-search-suggestion-panel" data-exp-component="search-suggestion"></div>
    <template id="exp-search-suggestion-option-template">
        <div class="exp-search-suggestion-option-container search-form-suggestion">
            <a class="exp-search-suggestion-option search-form-suggestion" href=""></a>
        </div>
    </template>
</div>


            <nav class="exp-sidebar-navigation">
                <div class="exp-sidebar-navigation-sticky-wrapper">
                    <iframe src="toc.html?pageId=371000790" border="0"></iframe>
                </div>

            </nav>


            <nav aria-label="Breadcrumb" class="exp-breadcrumbs-wrapper">
                <ol class="breadcrumbs">
                        <li class="breadcrumb">
                            <a href="SignServer_Documentation.html" rel="prev" target="_self">SignServer Documentation</a>
                        </li>
                        <li class="breadcrumb">
                            <a href="SignServer_Reference.html" rel="prev" target="_self">SignServer Reference</a>
                        </li>
                    <li class="breadcrumb active" aria-current="page">
                        Client-Side Hashing
                    </li>
                </ol>
            </nav>


            <main class="exp-content">
                <article role="article">

                    <header>
                        <h1 class="article-heading scroll-h1 scroll-original-h1 scroll-relative-h1 scroll-custom-section-heading scroll-document-section-heading" role="heading" data-scroll-heading-rank="1" data-scroll-original-heading-rank="1" data-scroll-relative-heading-rank="1" id="no-src_generated-id-954398af20f09a1e123ae190f0c91827ceefef1dc1926924e2efb5415933f5f5">
                            Client-Side Hashing
                        </h1>
                    </header>

                    <section class="page" id="content" role="main">
                        <div id="main-content" class="wiki-content article-content js-tocBot-content">
                            <p><style>[data-colorid=cw141j98ux]{color:#0e101a} html[data-color-mode=dark] [data-colorid=cw141j98ux]{color:#e5e7f1}[data-colorid=wr3yclxmbx]{color:#0e101a} html[data-color-mode=dark] [data-colorid=wr3yclxmbx]{color:#e5e7f1}[data-colorid=jsz79x3gpi]{color:#0e101a} html[data-color-mode=dark] [data-colorid=jsz79x3gpi]{color:#e5e7f1}[data-colorid=efuhharbd8]{color:#0e101a} html[data-color-mode=dark] [data-colorid=efuhharbd8]{color:#e5e7f1}[data-colorid=mezvr1npit]{color:#0e101a} html[data-color-mode=dark] [data-colorid=mezvr1npit]{color:#e5e7f1}[data-colorid=z0ky1prvv3]{color:#0e101a} html[data-color-mode=dark] [data-colorid=z0ky1prvv3]{color:#e5e7f1}[data-colorid=f4uh966ljs]{color:#0e101a} html[data-color-mode=dark] [data-colorid=f4uh966ljs]{color:#e5e7f1}[data-colorid=z5a74ks7yj]{color:#0e101a} html[data-color-mode=dark] [data-colorid=z5a74ks7yj]{color:#e5e7f1}[data-colorid=b095idadnm]{color:#0e101a} html[data-color-mode=dark] [data-colorid=b095idadnm]{color:#e5e7f1}[data-colorid=ifnzbtuzjm]{color:#0e101a} html[data-color-mode=dark] [data-colorid=ifnzbtuzjm]{color:#e5e7f1}[data-colorid=oevsbbgnzk]{color:#0e101a} html[data-color-mode=dark] [data-colorid=oevsbbgnzk]{color:#e5e7f1}[data-colorid=karibwz571]{color:#0e101a} html[data-color-mode=dark] [data-colorid=karibwz571]{color:#e5e7f1}[data-colorid=lyrbgxcvs3]{color:#0e101a} html[data-color-mode=dark] [data-colorid=lyrbgxcvs3]{color:#e5e7f1}[data-colorid=wcddm3ygnw]{color:#0e101a} html[data-color-mode=dark] [data-colorid=wcddm3ygnw]{color:#e5e7f1}[data-colorid=n7etg7xhau]{color:#0e101a} html[data-color-mode=dark] [data-colorid=n7etg7xhau]{color:#e5e7f1}[data-colorid=pewgalqlfg]{color:#0e101a} html[data-color-mode=dark] [data-colorid=pewgalqlfg]{color:#e5e7f1}[data-colorid=zys0u9je4s]{color:#0e101a} html[data-color-mode=dark] [data-colorid=zys0u9je4s]{color:#e5e7f1}</style>The following describes various options for performing the hashing on the client-side instead of making all the steps in the signing on the server-side. Client-side hashing is also sometimes referred to as "hash signing" and the main advantage is that the original file does not need to be sent to the server.</p><p></p><h2 id="Client-SideHashing-CMSDetachedSignatures" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="2" data-scroll-original-heading-rank="2" data-scroll-relative-heading-rank="2" class="scroll-original-h2 scroll-custom-section-heading scroll-document-section-heading scroll-h2 scroll-relative-h2">CMS Detached Signatures</h2><p>Detached signatures allow the signature to be placed in a separate file next to the original file, and thus the original file does not have to be updated. With CMS signatures, what is covered by the signature is a set of attributes (unless it is a direct signature) where one of the attributes is called messageDigest, which is the hash of the original file. This means that in order to create a CMS detached signature, it is sufficient to get the hash of the original file as input.</p><p>The <a href="CMS_Signer.html" data-linked-resource-id="370999849" data-linked-resource-version="2" data-linked-resource-type="page" data-scroll-target-source-id="370999849" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/370999849/CMS+Signer" data-scroll-link-target-source-id="370999849">CMS Signer</a> is for instance configured to accept a hash as input by setting CLIENTSIDEHASHING=TRUE, or by allowing the client to specify if the input is the original file or a hash of it, by configuring ALLOW_CLIENTSIDEHASHING_OVERRIDE=TRUE.</p><p>When the client sends the request, the following properties need to be provided as request metadata:</p><ul><li><pre>USING_CLIENTSUPPLIED_HASH=true</pre></li><li><pre>CLIENTSIDE_HASHDIGESTALGORITHM=SHA-256</pre></li></ul><p>where SHA-256 should be replaced with the name of the hash algorithm used to digest the data. The algorithm must be one of those configured in the signer with the ACCEPTED_HASH_DIGEST_ALGORITHMS property.</p><p>The following commands can be used to create a detached CMS signature using this mode with a CMSSigner set up to default to consider requests as client-side computed hash (using the CLIENTSIDEHASHING property) (assuming a GNU/Linux, or Unix-like system is used):</p><div class="scroll-code scroll-highlighted-code-block" data-title-type="code" data-theme="defaultnew" style="  counter-reset: scroll-code-numbering 0;"><div class="defaultnew content">
<div class="line"><code class="plain">$ echo </code><code class="string">"data-to-be-signed"</code><code class="plain"> | openssl sha256 -binary &gt; pre-computed-hash.bin</code></div>
<div class="line"><code class="plain">$ ./bin/signclient signdocument -workername CMSSigner</code></div>
<div class="line"><code class="plain">-metadata USING_CLIENTSUPPLIED_HASH=</code><code class="keyword">true</code><code class="plain"> -metadata CLIENTSIDE_HASHDIGESTALGORITHM=SHA-</code><code class="value">256</code></div>
<div class="line"><code class="plain">  -infile pre-computed-hash.bin -outfile signed.p7s</code></div>
</div>
</div><h2 id="Client-SideHashing-PlainSignatures" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="2" data-scroll-original-heading-rank="2" data-scroll-relative-heading-rank="2" class="scroll-original-h2 scroll-custom-section-heading scroll-document-section-heading scroll-h2 scroll-relative-h2"><span style="color: rgb(0,0,0);">Plain Signatures</span></h2><p><span style="color: rgb(0,0,0);">For plain signatures (as produced by the</span> <a href="Plain_Signer.html" data-linked-resource-id="370999934" data-linked-resource-version="1" data-linked-resource-type="page" data-scroll-target-source-id="370999934" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/370999934/Plain+Signer" data-scroll-link-target-source-id="370999934">Plain Signer</a>), <span style="color: rgb(0,0,0);">generally the whole file is sent to the signer and returned is the small signature. However, as the plain signature schemes involve a hash operation, it is possible to perform that on the client-side.</span></p><p><span style="color: rgb(0,0,0);">SignServer supports the following two options of using plain signatures with client-side hashing:</span></p><ol><li><span style="color: rgb(0,0,0);"><strong>Explicitly specifying client-side hashing using request metadata properties</strong>:<strong> </strong></span><span style="color: rgb(0,0,0);">Works with algorithms RSASSA-PKCS1_v1.5, RSASSA-PSS, and ECDSA, for known hash algorithms and is the recommended option as of SignServer version 5.9. See <span data-linked-resource-id="454787474" data-linked-resource-version="1" data-linked-resource-type="page">Explicitly using Request Metadata Properties</span>.<br clear="none"></span></li><li><span data-colorid="zys0u9je4s"><span style="color: rgb(0,0,0);"><strong>Implicitly using client-side hashing without request metadata properties</strong>:<strong> </strong>Supported for RSASSA-PKCS1_v1.5 and ECDSA but not for RSASSA-PSS. The input may also need special encoding, see <span data-linked-resource-id="454787474" data-linked-resource-version="1" data-linked-resource-type="page">Implicitly and With Encoding Depending on Algorithm</span>.</span></span></li></ol><h3 id="Client-SideHashing-YellowRecommendedExplicitlyusingRequestMetadataPropertiesAlt1" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="3" data-scroll-original-heading-rank="3" data-scroll-relative-heading-rank="3" class="scroll-original-h3 scroll-custom-section-heading scroll-document-section-heading scroll-h3 scroll-relative-h3"><span data-colorid="ifnzbtuzjm"><span style="color: rgb(0,0,0);"><span class="status-macro aui-lozenge aui-lozenge-current">recommended</span></span> Explicitly </span><span data-colorid="cw141j98ux">using Request Metadata Properties&nbsp;<span class="confluence-anchor-link" id="Client-SideHashing-Alt1"></span><span class="confluence-anchor-link" id="Alt1"></span><br clear="none"></span></h3><p><span data-colorid="z0ky1prvv3">We recommend explicitly specifying client-side hashing using request metadata properties. This is achieved by configuring</span><span data-colorid="efuhharbd8"> the <a href="Plain_Signer.html" data-linked-resource-id="370999934" data-linked-resource-version="1" data-linked-resource-type="page" data-scroll-target-source-id="370999934" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/370999934/Plain+Signer" data-scroll-link-target-source-id="370999934">Plain Signer</a> with CLIENTSIDEHASHING=true and SIGNATUREALGORITHM set to one of the <strong>NONEwith...</strong> signature algorithms and letting the client supply the <span style="color: rgb(0,0,0);">CLIENTSIDE_HASHDIGESTALGORITHM request metadata property in addition to the hash value as data. </span></span></p><p><span data-colorid="wcddm3ygnw"><span style="color: rgb(0,0,0);">This configuration works with algorithms NONEwithRSA (RSASSA-PKCS1_v1.5), NONEwithRSAandMGF1 (RSASSA-PSS), and NONEwithECDSA, for known hash algorithms and is recommended as of SignServer version 5.9.</span></span></p><p><span style="color: rgb(0,0,0);">When the client sends the request, the following properties need to be provided as request metadata:</span></p><ul><li><span style="color: rgb(0,0,0);">USING_CLIENTSUPPLIED_HASH=true (unless the signer is configured with CLIENTSIDEHASHING=true)</span></li><li><span style="color: rgb(0,0,0);">CLIENTSIDE_HASHDIGESTALGORITHM=SHA-256</span></li></ul><p><span style="color: rgb(0,0,0);">where SHA-256 is replaced with the name of the hash algorithm used to digest the data. The algorithm must be one of those configured in the signer with the ACCEPTED_HASH_DIGEST_ALGORITHMS property. For descriptions of available properties, see</span> <a href="Plain_Signer.html" data-linked-resource-id="370999934" data-linked-resource-version="1" data-linked-resource-type="page" data-scroll-target-source-id="370999934" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/370999934/Plain+Signer" data-scroll-link-target-source-id="370999934">Plain Signer</a> <span style="color: rgb(0,0,0);">and for algorithm support, see</span> <a href="Plain_Signer_Algorithm_Support.html" data-linked-resource-id="370999938" data-linked-resource-version="2" data-linked-resource-type="page" data-scroll-target-source-id="370999938" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/370999938/Plain+Signer+Algorithm+Support" data-scroll-link-target-source-id="370999938">Plain Signer Algorithm Support</a>.</p><h4 id="Client-SideHashing-ExampleforRSASSA-PKCS1_v1.5" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="4" data-scroll-original-heading-rank="4" data-scroll-relative-heading-rank="4" class="scroll-original-h4 scroll-custom-section-heading scroll-document-section-heading scroll-h4 scroll-relative-h4">Example for <span style="color: rgb(0,0,0);">RSASSA-PKCS1_v1.5</span></h4><div class="scroll-code scroll-highlighted-code-block" data-title-type="code" data-theme="defaultnew" style="  counter-reset: scroll-code-numbering 0;"><div class="defaultnew content">
<div class="line"><code class="plain">openssl x509 -in PlainSigner-certificate.pem -noout -pubkey &gt; plainsigner-pubkey.pem</code></div>
<div class="line"><code class="plain"> </code></div>
<div class="line"><code class="plain">openssl dgst -sha256 -out pre-computed-hash.bin -binary sample.txt</code></div>
<div class="line"><code class="plain">bin/signclient signdocument -workername PlainSigner -metadata USING_CLIENTSUPPLIED_HASH=</code><code class="keyword">true</code><code class="plain"> -metadata CLIENTSIDE_HASHDIGESTALGORITHM=SHA-</code><code class="value">256</code><code class="plain"> -infile pre-computed-hash.bin -outfile sample.sig</code></div>
<div class="line"><code class="plain">openssl dgst -signature sample.sig -verify plainsigner-pubkey.pem -SHA256 sample.txt</code></div>
</div>
</div><h4 class="auto-cursor-target scroll-original-h4 scroll-custom-section-heading scroll-document-section-heading scroll-h4 scroll-relative-h4" id="Client-SideHashing-ExampleforRSASSA-PSS" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="4" data-scroll-original-heading-rank="4" data-scroll-relative-heading-rank="4">Example for <span data-colorid="f4uh966ljs">RSASSA-PSS</span></h4><div class="scroll-code scroll-highlighted-code-block" data-title-type="code" data-theme="defaultnew" style="  counter-reset: scroll-code-numbering 0;"><div class="defaultnew content">
<div class="line"><code class="plain">openssl x509 -in PlainSigner-certificate.pem -noout -pubkey &gt; plainsigner-pubkey.pem</code></div>
<div class="line"><code class="plain"> </code></div>
<div class="line"><code class="plain">openssl dgst -sha256 -out pre-computed-hash.bin -binary sample.txt</code></div>
<div class="line"><code class="plain">bin/signclient signdocument -workername PlainSigner -metadata USING_CLIENTSUPPLIED_HASH=</code><code class="keyword">true</code><code class="plain"> -metadata CLIENTSIDE_HASHDIGESTALGORITHM=SHA-</code><code class="value">256</code><code class="plain"> -infile pre-computed-hash.bin -outfile sample.sig</code></div>
<div class="line"><code class="plain">openssl dgst -signature sample.sig -verify plainsigner-pubkey.pem -SHA256 -sigopt rsa_padding_mode:pss sample.txt</code></div>
</div>
</div><h3 id="Client-SideHashing-YellowLegacyImplicitlyandwithEncodingDependingonAlgorithmAlt2" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="3" data-scroll-original-heading-rank="3" data-scroll-relative-heading-rank="3" class="scroll-original-h3 scroll-custom-section-heading scroll-document-section-heading scroll-h3 scroll-relative-h3"><span data-colorid="wr3yclxmbx"><span style="color: rgb(0,0,0);"><span class="status-macro aui-lozenge aui-lozenge-current">legacy</span> </span></span><span data-colorid="jsz79x3gpi"><span style="color: rgb(0,0,0);">Implicitly and with Encoding Depending on Algorithm </span></span><span data-colorid="mezvr1npit"><span class="confluence-anchor-link" id="Client-SideHashing-Alt2"></span><span class="confluence-anchor-link" id="Alt2"></span></span></h3><p><span data-colorid="oevsbbgnzk"><span style="color: rgb(0,0,0);">The legacy way of accomplishing client-side hashing is to configure the <a href="Plain_Signer.html" data-linked-resource-id="370999934" data-linked-resource-version="1" data-linked-resource-type="page" data-scroll-target-source-id="370999934" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/370999934/Plain+Signer" data-scroll-link-target-source-id="370999934">Plain Signer</a> with a signature algorithm with the word NONE instead of the name of the hash and then let the client take care of sending in the input data encoded in the way expected by that signature algorithm. </span></span></p><p><span data-colorid="z5a74ks7yj"><span style="color: rgb(0,0,0);">In this case, CLIENTSIDEHASHING is set to false, or ALLOW_CLIENTSIDEHASHING_OVERRIDE is set to true, and the request specifies USING_CLIENTSUPPLIED_HASH=false. </span></span></p><p><span data-colorid="karibwz571"><span style="color: rgb(0,0,0);">Using this configuration, the hash is sent in differently depending on the algorithm:<br clear="none"></span></span></p><ul><li style="list-style-type: disc;" class="ql-indent-1"><span data-colorid="b095idadnm"><strong>NONEwithECDSA (ECDSA)</strong>: Send in the hash value.</span></li><li style="list-style-type: disc;" class="ql-indent-1"><span data-colorid="lyrbgxcvs3"><strong>NONEwithRSA (RSASSA-PKCS1_v1.5)</strong>: The input should be a DER encoded DigestInfo structure. Please refer to <a class="external-link scroll-external-link" href="https://datatracker.ietf.org/doc/html/rfc3447#page-42" rel="nofollow" shape="rect" data-scroll-link-type="default" data-scroll-link-target="https://datatracker.ietf.org/doc/html/rfc3447#page-42" data-scroll-link-local="false">RFC 3447</a> and specifically <a class="external-link scroll-external-link" href="https://datatracker.ietf.org/doc/html/rfc3447#page-42" rel="nofollow" shape="rect" data-scroll-link-type="default" data-scroll-link-target="https://datatracker.ietf.org/doc/html/rfc3447#page-42" data-scroll-link-local="false">page 42</a> for examples on the exact encoding. Alternatively, if the DigestInfo/ASN.1 structure is not wanted it could be left out when calling the signer.<br clear="none"></span></li><li style="list-style-type: disc;" class="ql-indent-1"><span data-colorid="n7etg7xhau"><strong>NONEwithRSAandMGF1 (RSASSA-PSS)</strong>: Not supported. Use the option <span data-linked-resource-id="454787474" data-linked-resource-version="1" data-linked-resource-type="page">Explicitly using Request Metadata Properties</span> instead.<br clear="none"></span></li></ul><p><span data-colorid="pewgalqlfg"><span style="color: rgb(0,0,0);">For descriptions of available properties, see</span> <a href="Plain_Signer.html" data-linked-resource-id="370999934" data-linked-resource-version="1" data-linked-resource-type="page" data-scroll-target-source-id="370999934" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/370999934/Plain+Signer" data-scroll-link-target-source-id="370999934">Plain Signer</a> <span style="color: rgb(0,0,0);">and for algorithm support, see</span> <a href="Plain_Signer_Algorithm_Support.html" data-linked-resource-id="370999938" data-linked-resource-version="2" data-linked-resource-type="page" data-scroll-target-source-id="370999938" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/370999938/Plain+Signer+Algorithm+Support" data-scroll-link-target-source-id="370999938">Plain Signer Algorithm Support</a>.</span></p><h4 id="Client-SideHashing-ExampleforECDSA" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="4" data-scroll-original-heading-rank="4" data-scroll-relative-heading-rank="4" class="scroll-original-h4 scroll-custom-section-heading scroll-document-section-heading scroll-h4 scroll-relative-h4"><span style="color: rgb(0,0,0);">Example for ECDSA<br clear="none"></span></h4><div class="scroll-code scroll-highlighted-code-block" data-title-type="code" data-theme="defaultnew" style="  counter-reset: scroll-code-numbering 0;"><div class="defaultnew content">
<div class="line"><code class="plain">openssl x509 -in PlainSigner-certificate.pem -noout -pubkey &gt; plainsigner-pubkey.pem</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">openssl dgst -sha256 -out pre-computed-hash.bin -binary sample.txt</code></div>
<div class="line"><code class="plain">bin/signclient signdocument -workername PlainSigner -infile pre-computed-hash.bin -outfile sample.sig</code></div>
<div class="line"><code class="plain">openssl dgst -signature sample.sig -verify plainsigner-pubkey.pem -SHA256 sample.txt</code></div>
</div>
</div><h2 id="Client-SideHashing-EmbeddedSignatureFormats" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="2" data-scroll-original-heading-rank="2" data-scroll-relative-heading-rank="2" class="scroll-original-h2 scroll-custom-section-heading scroll-document-section-heading scroll-h2 scroll-relative-h2">Embedded Signature Formats</h2><p>For signature formats where the signature is to be placed within the original document, additional logic has to be implemented on the client-side in order to, typically, first prepare the document for signing, compute the digest and send it to the server, and then finally embed the signature within the file.</p><p>On the client-side, support has been implemented for "client-side hashing and construction" for various signature formats (see below) for instance for Java Archives (.JAR, .APK,...) and for Authenticode signing of Portable Executable (PE) files (i.e. EXE, .DLL,..), Windows Installer files (.MSI) etc. Support for other file types such as PDF may also be implemented.</p><p>On the server-side, typically a CMS Signer is needed but since Authenticode and JAR signing are producing slightly different variants of the CMS signatures, different implementations are available for use. For instance for Authenticode, there is the <a href="MS_Authenticode_CMS_Signer.html" data-linked-resource-id="370999893" data-linked-resource-version="3" data-linked-resource-type="page" data-scroll-target-source-id="370999893" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/370999893/MS+Authenticode+CMS+Signer" data-scroll-link-target-source-id="370999893">MS Authenticode CMS Signer</a>, and for JAR signing the <a href="JArchive_CMS_Signer.html" data-linked-resource-id="370999869" data-linked-resource-version="2" data-linked-resource-type="page" data-scroll-target-source-id="370999869" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/370999869/JArchive+CMS+Signer" data-scroll-link-target-source-id="370999869">JArchive CMS Signer</a>.</p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup span="1"><col span="1"><col span="1"></colgroup><thead><tr><th colspan="1" rowspan="1" class="confluenceTh"><p>Parameter</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-clientside</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Required in order to use client-side hashing otherwise a normal request is sent.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-digestalgorithm</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>The digest algorithm to use for the hash (or for the hashes within the hash file depending on file type). This option may be ignored if the algorithm to be used is determined in other way by the implementation.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-filetype</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Optional. One of the supported file type identifiers (see below). If not provided the implementation tries to guess the file type base on the file extension or content of the file.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-extraoption KEY=VALUE</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Flag to provide extra options for signing supported by a particular file type.</p></td></tr></tbody></table></div><h2 id="Client-SideHashing-AuthenticodeSigning" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="2" data-scroll-original-heading-rank="2" data-scroll-relative-heading-rank="2" class="scroll-original-h2 scroll-custom-section-heading scroll-document-section-heading scroll-h2 scroll-relative-h2">Authenticode Signing</h2><p><span class="status-macro aui-lozenge aui-lozenge-complete">enterprise</span></p><p>When using the client-side hashing and construction for Authenticode file signing using the <a href="MS_Authenticode_CMS_Signer.html" data-linked-resource-id="370999893" data-linked-resource-version="3" data-linked-resource-type="page" data-scroll-target-source-id="370999893" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/370999893/MS+Authenticode+CMS+Signer" data-scroll-link-target-source-id="370999893">MS Authenticode CMS Signer</a> the following options are available. Note that the MS Authenticode Signer supports the following formats:</p><ul><li>PE: Portable Executable files (.exe, .dll, ...)</li><li>MSI: Windows Installer files (.msi)</li><li>PS1: PowerShell (.ps1, .psd, .psm)</li><li>CAB: Cabinet archives (.cab)</li></ul><p>Another signer is available for signing of AppX/MSIX. See the APPX Signing section.</p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup span="1"><col span="1"><col span="1"></colgroup><thead><tr><th colspan="1" rowspan="1" class="confluenceTh"><p>Parameter</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-clientside</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Required in order to use client-side hashing otherwise a normal request is sent.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-digestalgorithm</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>The digest algorithm to use for the hash.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-filetype PE</p><p>-filetype MSI</p><p>-filetype PS1</p><p>-filetype CAB</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Optional. For specifying a particular file type. If not provided SignClient will try to guess the type.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-extraoption ENCODING=</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>For more information on the property ENCODING, see <a href="MS_Authenticode_Signer.html" data-linked-resource-id="370999897" data-linked-resource-version="2" data-linked-resource-type="page" data-scroll-target-source-id="370999897" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/370999897/MS+Authenticode+Signer" data-scroll-link-target-source-id="370999897">MS Authenticode Signer</a>.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-extraoption KEEPSIGNATURES=</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>For more information on the property KEEPSIGNATURE, see <a href="MS_Authenticode_Signer.html" data-linked-resource-id="370999897" data-linked-resource-version="2" data-linked-resource-type="page" data-scroll-target-source-id="370999897" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/370999897/MS+Authenticode+Signer" data-scroll-link-target-source-id="370999897">MS Authenticode Signer</a>.</p></td></tr></tbody></table></div><h3 id="Client-SideHashing-SampleUsage" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="3" data-scroll-original-heading-rank="3" data-scroll-relative-heading-rank="3" class="scroll-original-h3 scroll-custom-section-heading scroll-document-section-heading scroll-h3 scroll-relative-h3">Sample Usage</h3><div class="scroll-code scroll-highlighted-code-block" data-title-type="code" data-theme="defaultnew" style="  counter-reset: scroll-code-numbering 0;"><div class="defaultnew content">
<div class="line"><code class="plain">$ signclient signdocument -clientside -workername MSAuthCodeCMSSigner -infile unsigned.exe</code></div>
<div class="line"><code class="plain">-outfile signed.exe -digestalgorithm SHA-</code><code class="value">512</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">$ signclient signdocument -clientside -workername MSAuthCodeCMSSigner -infile unsigned.msi</code></div>
<div class="line"><code class="plain">-outfile signed.msi -digestalgorithm SHA-</code><code class="value">256</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">$ signclient signdocument -clientside -workername MSAuthCodeCMSSigner -infile unsigned.ps1</code></div>
<div class="line"><code class="plain">-outfile signed.ps1 -digestalgorithm SHA-</code><code class="value">256</code></div>
</div>
</div><h2 id="Client-SideHashing-JARSigning" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="2" data-scroll-original-heading-rank="2" data-scroll-relative-heading-rank="2" class="scroll-original-h2 scroll-custom-section-heading scroll-document-section-heading scroll-h2 scroll-relative-h2">JAR Signing</h2><p><span class="status-macro aui-lozenge aui-lozenge-complete">enterprise</span></p><p>When using the client-side hashing and construction for JAR file signing using the <a href="JArchive_CMS_Signer.html" data-linked-resource-id="370999869" data-linked-resource-version="2" data-linked-resource-type="page" data-scroll-target-source-id="370999869" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/370999869/JArchive+CMS+Signer" data-scroll-link-target-source-id="370999869">JArchive CMS Signer</a>, the following options are available.</p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup span="1"><col span="1"><col span="1"></colgroup><thead><tr><th colspan="1" rowspan="1" class="confluenceTh"><p>Parameter</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-clientside</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Required in order to use client-side hashing otherwise a normal request is sent.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-digestalgorithm</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>The digest algorithm to use for the hashes in the manifest / signature file.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-filetype ZIP</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Specify that a ZIP/JAR signature is wanted.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-extraoption KEEPSIGNATURE=</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>For more information on the property KEEPSIGNATURE, see <a href="JArchive_Signer.html" data-linked-resource-id="370999873" data-linked-resource-version="1" data-linked-resource-type="page" data-scroll-target-source-id="370999873" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/370999873/JArchive+Signer" data-scroll-link-target-source-id="370999873">JArchive Signer</a>.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-extraoption REPLACESIGNATURE=</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>For more information on the property REPLACESIGNATURE, see <a href="JArchive_Signer.html" data-linked-resource-id="370999873" data-linked-resource-version="1" data-linked-resource-type="page" data-scroll-target-source-id="370999873" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/370999873/JArchive+Signer" data-scroll-link-target-source-id="370999873">JArchive Signer</a>.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-extraoption SIGNATURE_NAME_VALUE=</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>For more information on the property SIGNATURE_NAME_VALUE, see <a href="JArchive_Signer.html" data-linked-resource-id="370999873" data-linked-resource-version="1" data-linked-resource-type="page" data-scroll-target-source-id="370999873" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/370999873/JArchive+Signer" data-scroll-link-target-source-id="370999873">JArchive Signer</a>.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-extraoption ZIPALIGN=</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>For more information on the property ZIPALIGN, see <a href="JArchive_Signer.html" data-linked-resource-id="370999873" data-linked-resource-version="1" data-linked-resource-type="page" data-scroll-target-source-id="370999873" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/370999873/JArchive+Signer" data-scroll-link-target-source-id="370999873">JArchive Signer</a>.</p></td></tr></tbody></table></div><h3 id="Client-SideHashing-SampleUsage.1" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="3" data-scroll-original-heading-rank="3" data-scroll-relative-heading-rank="3" class="scroll-original-h3 scroll-custom-section-heading scroll-document-section-heading scroll-h3 scroll-relative-h3">Sample Usage</h3><div class="scroll-code scroll-highlighted-code-block" data-title-type="code" data-theme="defaultnew" style="  counter-reset: scroll-code-numbering 0;"><div class="defaultnew content">
<div class="line"><code class="plain">$ signclient signdocument -clientside -workername JArchiveCMSSigner -infile unsigned.jar</code></div>
<div class="line"><code class="plain">-outfile signed.jar -digestalgorithm SHA-</code><code class="value">256</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">$ signclient signdocument -clientside -workername JArchiveCMSSigner -infile unsigned.apk</code></div>
<div class="line"><code class="plain">-outfile signed.apk -digestalgorithm SHA-</code><code class="value">256</code><code class="plain"> -extraoption ZIPALIGN=TRUE -extraoption SIGNATURE_NAME_VALUE=SIGNER02</code></div>
</div>
</div><h2 id="Client-SideHashing-OpenPGPSigning" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="2" data-scroll-original-heading-rank="2" data-scroll-relative-heading-rank="2" class="scroll-original-h2 scroll-custom-section-heading scroll-document-section-heading scroll-h2 scroll-relative-h2">OpenPGP Signing</h2><p><span class="status-macro aui-lozenge aui-lozenge-complete">enterprise</span></p><p>When using the client-side hashing and construction with OpenPGP using the OpenPGPPlainSigner, the parameters key ID and key algorithm (when using a key with an algorithm other than RSA) need to be specified with the request using the <code>-extraoption</code> options.</p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup span="1"><col span="1"><col span="1"></colgroup><thead><tr><th colspan="1" rowspan="1" class="confluenceTh"><p>Parameter</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-filetype PGP</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Specify that an OpenPGP signature is wanted.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-extraoption KEY_ID=</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Key ID (in hex format) for the PGP public key. Default: "3" (RSA)</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-extraoption KEY_ALGORITHM=</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Key algorithm, either in text format (RSA or ECDSA) or numeric decimal format.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-extraoption RESPONSE_FORMAT=</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Format of the output. Either binary or ASCII armored. Examples: "BINARY", "ARMORED". Optional. Default: "ARMORED".</p><p>RESPONSE_FORMAT can be only be provided as "ARMORED" when DETACHED_SIGNATURE extra option is provided as "FALSE"</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-extraoption DETACHED_SIGNATURE=</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Property specifying if a detached signature should be used or otherwise a clear-text signature.<span> </span>Examples: "true", "false". Required.</p></td></tr></tbody></table></div><h3 id="Client-SideHashing-SampleUsage.2" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="3" data-scroll-original-heading-rank="3" data-scroll-relative-heading-rank="3" class="scroll-original-h3 scroll-custom-section-heading scroll-document-section-heading scroll-h3 scroll-relative-h3">Sample Usage</h3><div class="scroll-code scroll-highlighted-code-block" data-title-type="code" data-theme="defaultnew" style="  counter-reset: scroll-code-numbering 0;"><div class="defaultnew content">
<div class="line"><code class="plain">$ signclient signdocument -workername OpenPGPPlainSigner -clientside -digestalgorithm SHA-</code><code class="value">256</code><code class="plain"> -filetype PGP\</code></div>
<div class="line"><code class="plain">-infile file-to-be-signed -outfile signed-file -extraoption KEY_ID=1234567890ABC -extraoption KEY_ALGORITHM=ECDSA\</code></div>
<div class="line"><code class="plain">-extraoption RESPONSE_FORMAT=ARMORED -extraoption DETACHED_SIGNATURE=TRUE</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">$ signclient signdocument -workername OpenPGPPlainSigner -clientside -digestalgorithm SHA-</code><code class="value">256</code><code class="plain"> -filetype PGP\</code></div>
<div class="line"><code class="plain">-infile file-to-be-signed -outfile signed-file -extraoption KEY_ID=1234567890ABC -extraoption KEY_ALGORITHM=ECDSA\</code></div>
<div class="line"><code class="plain">-extraoption RESPONSE_FORMAT=ARMORED -extraoption DETACHED_SIGNATURE=FALSE</code></div>
</div>
</div><h2 id="Client-SideHashing-DebianDpkg-sigSigning" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="2" data-scroll-original-heading-rank="2" data-scroll-relative-heading-rank="2" class="scroll-original-h2 scroll-custom-section-heading scroll-document-section-heading scroll-h2 scroll-relative-h2">Debian Dpkg-sig Signing</h2><p><span class="status-macro aui-lozenge aui-lozenge-complete">enterprise</span></p><p>When using the client-side hashing and construction with Dpkg-sig using the OpenPGPPlainSigner, the key ID, key fingerprint, and key algorithm (when using a key with an algorithm other than RSA) need to be specified with the request using the <code>-extraoption</code> options.</p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup span="1"><col span="1"><col span="1"></colgroup><thead><tr><th colspan="1" rowspan="1" class="confluenceTh"><p>Parameter</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td colspan="1" rowspan="1" style="text-align: left;" class="confluenceTd"><p>-filetype DPKG_SIG</p></td><td colspan="1" rowspan="1" style="text-align: left;" class="confluenceTd"><p>Specify that a Debian Dpkg-sig signature is wanted.</p></td></tr><tr><td colspan="1" rowspan="1" style="text-align: left;" class="confluenceTd"><p>-extraoption KEY_ID=</p></td><td colspan="1" rowspan="1" style="text-align: left;" class="confluenceTd"><p>Key ID (in hex format) for the PGP public key.</p></td></tr><tr><td colspan="1" rowspan="1" style="text-align: left;" class="confluenceTd"><p>-extraoption KEY_ALGORITHM=</p></td><td colspan="1" rowspan="1" style="text-align: left;" class="confluenceTd"><p>Key algorithm, either in text format (RSA or ECDSA) or numeric decimal format.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-extraoption KEY_FINGERPRINT=</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Key fingerprint (in hex format) for the PGP public key. This is included in the signed manifest.</p></td></tr></tbody></table></div><div class="confluence-information-macro confluence-information-macro-tip"><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>You can run without the required KEY_ options and the server will give an error message that includes the values that can be used.</p></div></div><h3 id="Client-SideHashing-SampleUsages" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="3" data-scroll-original-heading-rank="3" data-scroll-relative-heading-rank="3" class="scroll-original-h3 scroll-custom-section-heading scroll-document-section-heading scroll-h3 scroll-relative-h3">Sample Usages</h3><p>The key ID is the hex-encoded representation, and the key algorithm can be specified as either a name (RSA or ECDSA) or using one of the PGP constant values (for example 19 for ECDSA).</p><div class="scroll-code scroll-highlighted-code-block" data-title-type="code" data-theme="defaultnew" style="  counter-reset: scroll-code-numbering 0;"><div class="defaultnew content">
<div class="line"><code class="plain">$ signclient signdocument -workername OpenPGPPlainSigner -clientside -digestalgorithm SHA-</code><code class="value">256</code><code class="plain"> -filetype DPKG_SIG\</code></div>
<div class="line"><code class="plain">-infile hello.deb -outfile hello-signed.deb -extraoption KEY_ID=4B821662F54A5923 -extraoption KEY_ALGORITHM=ECDSA\</code></div>
<div class="line"><code class="plain"> -extraoption KEY_FINGERPRINT=23C0B776EEE6A30D6530ACD44B821662F54A5923</code></div>
<div class="line"><code class="plain"> </code></div>
<div class="line"><code class="plain">$ signclient signdocument -workername OpenPGPPlainSigner -clientside -digestalgorithm SHA-</code><code class="value">256</code><code class="plain"> -filetype DPKG_SIG\</code></div>
<div class="line"><code class="plain">-infile hello.deb -outfile hello-signed.deb -extraoption KEY_ID=4B821662F54A5923 -extraoption KEY_ALGORITHM=</code><code class="value">19</code><code class="plain">\</code></div>
<div class="line"><code class="plain"> -extraoption KEY_FINGERPRINT=23C0B776EEE6A30D6530ACD44B821662F54A5923</code></div>
</div>
</div><h2 id="Client-SideHashing-DNSSECSigning" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="2" data-scroll-original-heading-rank="2" data-scroll-relative-heading-rank="2" class="scroll-original-h2 scroll-custom-section-heading scroll-document-section-heading scroll-h2 scroll-relative-h2">DNSSEC Signing</h2><p><span class="status-macro aui-lozenge aui-lozenge-complete">enterprise</span></p><p>When using the client-side hashing and construction for DNSSEC zone file signing using the <a href="ZoneHashSigner.html" data-linked-resource-id="371000002" data-linked-resource-version="1" data-linked-resource-type="page" data-scroll-target-source-id="371000002" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/371000002/ZoneHashSigner" data-scroll-link-target-source-id="371000002">ZoneHashSigner</a>, the following <code>-extraoption</code> options should be provided on the command line in addition to the required request metadata property specifying which keys to use.</p><div class="table-wrap"><table class="wrapped relative-table confluenceTable" style="width: 100.0%;"><colgroup span="1"><col span="1" style="width: 16.1798%;"></colgroup><colgroup span="1"><col span="1" style="width: 83.8202%;"></colgroup><thead><tr><th colspan="1" rowspan="1" class="confluenceTh"><p>Parameter</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-clientside</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Required in order to use client-side hashing otherwise a normal request is sent.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-digestalgorithm</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>The digest algorithm to use for the hash.</p></td></tr><tr><td colspan="1" rowspan="1" style="text-align: left;" class="confluenceTd"><p>-filetype ZONE_ZIP</p></td><td colspan="1" rowspan="1" style="text-align: left;" class="confluenceTd"><p>Specify that a DNS zone file is provided in the ZIP file. The first file in the archive must be the new (unsigned) zone file. Optionally, the previously signed zone file can be provided after it and in which case valid signatures from it may be re-used.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-metadata ZSK_SEQUENCE_NUMBER=</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Sequence number of the ZSK key to use. The key with this sequence number will be used to sign the record and the next key in sequence will be included (a.k.a. pre-published).</p></td></tr><tr><td colspan="1" rowspan="1" style="text-align: left;" class="confluenceTd"><p>-extraoption ZONE_NAME=</p></td><td colspan="1" rowspan="1" style="text-align: left;" class="confluenceTd"><p>Absolute domain name. Example: "example.com." Required</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-extraoption <span style="color: rgb(51,51,51);">MIN_REMAINING_VALIDITY</span>=</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><span style="color: rgb(51,51,51);">Minimum remaining time in seconds required to be able to re-use a previously signed record instead of resigning it. Required unless FORCE_RESIGN=TRUE</span></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><span style="color: rgb(51,51,51);">-extraoption FORCE_RESIGN=</span></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>If set to "true", do not consider the minimum remaining validity and instead re-sign all records even if they are not expired. This should be done when a new key should be used for signing (i.e. when the ZSK_SEQUENCE_NUMBER is increased). Default: FALSE</p></td></tr></tbody></table></div><h3 id="Client-SideHashing-SampleUsages.1" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="3" data-scroll-original-heading-rank="3" data-scroll-relative-heading-rank="3" class="scroll-original-h3 scroll-custom-section-heading scroll-document-section-heading scroll-h3 scroll-relative-h3">Sample Usages</h3><div class="scroll-code scroll-highlighted-code-block" data-title-type="code" data-theme="defaultnew" style="  counter-reset: scroll-code-numbering 0;"><div class="defaultnew content">
<div class="line"><code class="plain">$ signclient signdocument -workername ZoneHashSigner -clientside -digestalgorithm SHA-</code><code class="value">256</code><code class="plain"> -filetype ZONE_ZIP\</code></div>
<div class="line"><code class="plain">-infile example.com.zone.zip -outfile example.com-signed.zone -metadata ZSK_SEQUENCE_NUMBER=</code><code class="value">1</code><code class="plain"> -extraoption ZONE_NAME=example.com. -extraoption MIN_REMAINING_VALIDITY=</code><code class="value">86400</code></div>
</div>
</div><h2 id="Client-SideHashing-APPXSigning" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="2" data-scroll-original-heading-rank="2" data-scroll-relative-heading-rank="2" class="scroll-original-h2 scroll-custom-section-heading scroll-document-section-heading scroll-h2 scroll-relative-h2">APPX Signing</h2><p><span class="status-macro aui-lozenge aui-lozenge-complete">enterprise</span></p><p>When using the client-side hashing and construction for Appx file signing using the&nbsp;<a href="Appx_CMS_Signer.html" data-linked-resource-id="370999821" data-linked-resource-version="2" data-linked-resource-type="page" data-scroll-target-source-id="370999821" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/370999821/Appx+CMS+Signer" data-scroll-link-target-source-id="370999821">Appx CMS Signer</a>, the following options are available.</p><div class="table-wrap"><table class="relative-table wrapped confluenceTable" style="width: 100.0%;"><colgroup span="1"><col span="1" style="width: 16.1798%;"></colgroup><colgroup span="1"><col span="1" style="width: 83.8202%;"></colgroup><thead><tr><th colspan="1" rowspan="1" class="confluenceTh"><p>Parameter</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-clientside</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Required in order to use client-side hashing otherwise a normal request is sent.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-digestalgorithm</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>The digest algorithm to use for the hash.</p></td></tr><tr><td colspan="1" rowspan="1" style="text-align: left;" class="confluenceTd"><p>-filetype APPX</p></td><td colspan="1" rowspan="1" style="text-align: left;" class="confluenceTd"><p>Specify that an APPX file is provided for signing.&nbsp;</p></td></tr></tbody></table></div><h3 id="Client-SideHashing-SampleUsages.2" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="3" data-scroll-original-heading-rank="3" data-scroll-relative-heading-rank="3" class="scroll-original-h3 scroll-custom-section-heading scroll-document-section-heading scroll-h3 scroll-relative-h3">Sample Usages</h3><div class="scroll-code scroll-highlighted-code-block" data-title-type="code" data-theme="defaultnew" style="  counter-reset: scroll-code-numbering 0;"><div class="defaultnew content">
<div class="line"><code class="plain">$ signclient signdocument -workername AppxCMSSigner -infile HelloAppx.appx -outfile HelloAppx-signed.appx -clientside -digestalgorithm SHA-</code><code class="value">256</code><code class="plain"> -filetype APPX</code></div>
</div>
</div><h2 id="Client-SideHashing-APKSigning" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="2" data-scroll-original-heading-rank="2" data-scroll-relative-heading-rank="2" class="scroll-original-h2 scroll-custom-section-heading scroll-document-section-heading scroll-h2 scroll-relative-h2">APK Signing</h2><p><span class="status-macro aui-lozenge aui-lozenge-complete">enterprise</span></p><p>When using the client-side hashing and construction for Android Package Kit (APK) file signing using the <a href="APK_Hash_Signer.html" data-linked-resource-id="370999809" data-linked-resource-version="4" data-linked-resource-type="page" data-scroll-target-source-id="370999809" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/370999809/APK+Hash+Signer" data-scroll-link-target-source-id="370999809">APK Hash Signer</a>, the following -extraoptions can be used.</p><div class="table-wrap"><table class="relative-table wrapped confluenceTable"><colgroup span="1"><col span="1" style="width: 16.1798%;"></colgroup><colgroup span="1"><col span="1" style="width: 83.8202%;"></colgroup><thead><tr><th colspan="1" rowspan="1" class="confluenceTh"><p>Parameter</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-clientside</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Required in order to use client-side hashing otherwise a normal request is sent.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-digestalgorithm</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Any valid digest algorithm value (e.g. "SHA-256") needs to be supplied but is ignored as the algorithm to be used is determined based on key size and API level.</p></td></tr><tr><td colspan="1" rowspan="1" style="text-align: left;" class="confluenceTd"><p><span style="color: rgb(0,0,0);">-filetype APK</span></p></td><td colspan="1" rowspan="1" style="text-align: left;" class="confluenceTd"><p><span style="color: rgb(0,0,0);">Specify that an APK file is provided for signing.</span></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-extraoption V1_SIGNATURE=</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><span style="color: rgb(0,0,0);">Enable (true) to Include APK version 1 signature. Valid values: true or false. If not set, will use default behavior depending on SDK version.<br clear="none"></span></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-extraoption V2_SIGNATURE=</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><span style="color: rgb(0,0,0);">Enable (true) to Include APK version 2 signature. Valid values: true or false. If not set, will use default behavior depending on SDK version.</span></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-extraoption V3_SIGNATURE=</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><span style="color: rgb(0,0,0);">Enable (true) to Include APK version 3 signature. Valid values: true or false. If not set, will use default behavior depending on SDK version.</span></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-extraoption V1_SIGNATURE_NAME=</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><span style="color: rgb(0,0,0);">Minimum SDK version of APK supported to be signed. Valid values: a positive integer.<br clear="none"></span></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-extraoption MIN_SDK_VERSION=</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><span style="color: rgb(0,0,0);">Minimum SDK version of APK supported to be signed. Valid values: a positive integer.</span></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-extraoption MAX_SDK_VERSION=</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><span style="color: rgb(0,0,0);">Maximum SDK version of APK supported to be signed. Valid values: a positive integer. Note, this parameter is not currently enforced, but reserved for future use.<br clear="none"></span></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>-extraoption DEBUGGABLE_APK_PERMITTED=</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><span style="color: rgb(0,0,0);">True if debuggable APK should be allowed to be signed. Valid values: true, or false. If not set, debuggable APKs will not be permitted.<br clear="none"></span></p></td></tr></tbody></table></div><h3 id="Client-SideHashing-AlgorithmSupport" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="3" data-scroll-original-heading-rank="3" data-scroll-relative-heading-rank="3" class="scroll-original-h3 scroll-custom-section-heading scroll-document-section-heading scroll-h3 scroll-relative-h3">Algorithm Support</h3><p>SignClient assumes the server-side signer is configured with either NONEwithECDSA, or NONEwithRSA as signature algorithm. SignClient currently supports SHA1, SHA-256, SHA-384, and SHA-512 with RSA and SHA1, SHA-224, SHA-256, SHA-384, and SHA-512 with ECDSA.&nbsp;</p><h3 id="Client-SideHashing-SampleUsages.3" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="3" data-scroll-original-heading-rank="3" data-scroll-relative-heading-rank="3" class="scroll-original-h3 scroll-custom-section-heading scroll-document-section-heading scroll-h3 scroll-relative-h3">Sample Usages</h3><div class="scroll-code scroll-highlighted-code-block" data-title-type="code" data-theme="defaultnew" style="  counter-reset: scroll-code-numbering 0;"><div class="defaultnew content">
<div class="line"><code class="plain">$ signclient -workername ApkHashSigner -infile unsigned.apk -outfile signed.apk -clientside -digestalgorithm SHA-</code><code class="value">256</code><code class="plain"> -filetype APK</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">$ signclient -workername ApkHashSigner -infile unsigned.apk -outfile signed.apk -clientside -digestalgorithm SHA-</code><code class="value">256</code><code class="plain"> -filetype APK -extraoption V3_SIGNATURE=</code><code class="keyword">false</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">$ signclient -workername ApkHashSigner -infile unsigned.apk -outfile signed.apk -clientside -digestalgorithm SHA-</code><code class="value">256</code><code class="plain"> -filetype APK -extraoption V1_SIGNATURE=</code><code class="keyword">true</code></div>
</div>
</div>
                        </div>
                    </section>

                </article>
            </main>


                <nav class="exp-post-navigation-prev">
                    <a href="Peer_Systems.html" class="post-navigation-link">
                        <svg width="22px" height="22px" viewbox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg">
                            <g id="ht-icon-prev">
                                <path fill="currentColor" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2" transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) " />
                            </g>
                        </svg>
                        <span>Peer Systems</span>
                    </a>
                </nav>

                <nav class="exp-post-navigation-next">

                    <a href="Key_Wrapping.html" class="post-navigation-link">
                        <span>Key Wrapping</span>
                        <svg width="22px" height="22px" viewbox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg">
                            <g id="ht-icon-next">
                                <path fill="currentColor" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2" transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) " />
                            </g>
                        </svg>
                    </a>

                </nav>


            <nav class="exp-sidebar-toc js-tocBot">
                <!-- content generated by toc.js  -->
            </nav>

            <div class="exp-sidebar-navigation-toggle">
                <div class="exp-sidebar-navigation-toggle-icon-line"></div>
                <div class="exp-sidebar-navigation-toggle-icon-line"></div>
                <div class="exp-sidebar-navigation-toggle-icon-line"></div>
            </div>

            <div class="exp-scroll-to-top-container">
                <a href="#Client-SideHashing-top" class="exp-scroll-to-top-link">↑ Back to top</a>
            </div>

        </div>



<dialog class="exp-lightbox-container" aria-modal="true">
    <div class="lightbox-toolbar">
        <button type="button" class="exp-lightbox-close">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 -960 960 960" aria-hidden="true">
                <path fill="currentColor" d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z" />
            </svg>
        </button>
    </div>
    <div class="lightbox-content content">
    </div>
</dialog>

<template id="exp-lightbox-wrapper-template">
    <div class="exp-lightbox-wrapper">
        <div class="exp-lightbox-toggle">
            <button type="button" class="exp-lightbox-close">
                <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 -960 960 960" aria-hidden="true">
                    <path fill="currentColor" d="M120-120v-320h80v184l504-504H520v-80h320v320h-80v-184L256-200h184v80H120Z" />
                </svg>
            </button>
        </div>
    </div>
</template>

        <script src="js/tocbot.min.js"></script>
        <script src="js/article-toc.js"></script>
        <script src="js/app.js"></script>
        <script src="js/mobile.js"></script>
        <script src="js/iframe-resizer.parent.js"></script>

    </body>

</html>